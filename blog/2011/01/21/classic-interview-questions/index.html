
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Classic Interview Questions - Personal Interview Notes</title>
  <meta name="author" content="Cuong Dong-Si">

  
  <meta name="description" content="There are reasons that these interview questions are just popular. Merge intervals Given a collection of intervals (start, end), merge all &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tdongsi.github.io/SqlTests/blog/2011/01/21/classic-interview-questions/">
  <link href="/SqlTests/favicon.png" rel="icon">
  <link href="/SqlTests/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Personal Interview Notes" type="application/atom+xml">
  <script src="/SqlTests/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/SqlTests/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/SqlTests/">Personal Interview Notes</a></h1>
  
    <h2>Neither success nor failure is ever final.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="tdongsi.github.io/SqlTests">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/SqlTests/">Blog Home</a></li>
  <li><a href="/SqlTests/blog/archives">Archives</a></li>
  <li><a href="/SqlTests/syllabus">Syllabus</a></li>
  <li><a href="http://tdongsi.github.io">Personal Home</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Classic Interview Questions</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-01-21T15:18:42-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2011</span></span> <span class='time'>3:18 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>There are reasons that these interview questions are just popular.</p>

<!--more-->


<h3>Merge intervals</h3>

<p>Given a collection of intervals (start, end), merge all overlapping intervals.</p>

<p>Example: <code>[[1, 4], [4, 5], [3, 4]] -&gt; [[1, 5]]</code></p>

<figure class='code'><figcaption><span>Merge intervals</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">merge_intervals</span><span class="p">(</span><span class="n">mlol</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Given a collection of intervals, merge all overlapping intervals.</span>
</span><span class='line'>
</span><span class='line'><span class="sd">    :param mlol: List of lists</span>
</span><span class='line'><span class="sd">    :return: overlapping intervals.</span>
</span><span class='line'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="n">mlol</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">mlol</span><span class="p">:</span>
</span><span class='line'>        <span class="c"># if the output list is empty or if the current interval does not overlap with the previous,</span>
</span><span class='line'>        <span class="c"># simply append it.</span>
</span><span class='line'>        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span> <span class="ow">or</span> <span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span class='line'>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</span><span class='line'>        <span class="k">else</span><span class="p">:</span>
</span><span class='line'>            <span class="c"># otherwise, there is overlap, so we combine the current and previous intervals.</span>
</span><span class='line'>            <span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">output</span>
</span></code></pre></td></tr></table></div></figure>


<h3>How to implement a hash map</h3>

<p><a href="https://www.geeksforgeeks.org/internal-working-of-hashmap-java/">https://www.geeksforgeeks.org/internal-working-of-hashmap-java/</a></p>

<p>ArrayList of LinkedList of Entry (Key, Value).
Convert hashcode of Key to integer index (H % bucket).
Use index to move in array.
Use Key to find entry in LinkedList.</p>

<h3>Reverse linked list. Find cycle in linked list</h3>

<p>The first problem &ldquo;reversing a linked list&rdquo; used to be the &ldquo;foobar&rdquo; challenge, although slightly harder.
They just want to check if you know the most basic stuffs.
Now, they are usually used as a warm-up question.
However, there is a reason for &ldquo;foobar&rdquo; challenges since reversing linked list can be tricky with corner cases even for experienced but ill-prepared candidates.
In addition, if you are interviewing for senior positions, they expect you to solve this question quickly (as if you do interview every single day).
So, you usually have no choice but make sure that you can do this problem quickly.</p>

<figure class='code'><figcaption><span>Reverse linked list</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">reverse_list</span><span class="p">(</span><span class="n">head</span><span class="p">:</span><span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
</span><span class='line'>    <span class="sd">&quot;&quot;&quot; Write a function that reverses a linked list</span>
</span><span class='line'><span class="sd">    :param head: The head of the linked list.</span>
</span><span class='line'><span class="sd">    :return: The new head of the reversed list.</span>
</span><span class='line'><span class="sd">    &quot;&quot;&quot;</span>
</span><span class='line'>    <span class="n">prev</span> <span class="o">=</span> <span class="bp">None</span>
</span><span class='line'>    <span class="n">cur</span> <span class="o">=</span> <span class="n">head</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">while</span> <span class="n">cur</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
</span><span class='line'>        <span class="n">temp</span> <span class="o">=</span> <span class="n">cur</span>
</span><span class='line'>        <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">get_next</span><span class="p">()</span>
</span><span class='line'>        <span class="n">temp</span><span class="o">.</span><span class="n">set_next</span><span class="p">(</span><span class="n">prev</span><span class="p">)</span>
</span><span class='line'>        <span class="n">prev</span> <span class="o">=</span> <span class="n">temp</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">prev</span>
</span></code></pre></td></tr></table></div></figure>


<p>Check if there is a cycle in a linked list.
TODO: Floyd algorithm.</p>

<h3>LRU Cache</h3>

<p>The LRU cache can be easily implemented in Java using LinkedHashMap.
There is a <code>protected</code> method that allow you to override to specify the cache size.
TODO: that method.</p>

<p>In Python, the natural equivalent to Java&rsquo;s LinkedHashMap is OrderedDict.
In fact, one implementation of LRU cache can be as follows:</p>

<figure class='code'><figcaption><span>LRU cache</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">class</span> <span class="nc">LRUCache</span><span class="p">:</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span class='line'>        <span class="k">try</span><span class="p">:</span>
</span><span class='line'>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span class='line'>            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">value</span>
</span><span class='line'>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span class='line'>            <span class="k">return</span> <span class="bp">None</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span class='line'>        <span class="k">try</span><span class="p">:</span>
</span><span class='line'>            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span class='line'>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span class='line'>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
</span><span class='line'>                <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">popitem</span><span class="p">(</span><span class="n">last</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class='line'>        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Singleton design pattern</h3>

<p>This question seems to be common because it shows that if a candidate knows “design pattern”, best practices, concurrency (<code>synchronized</code>, <code>volatile</code> keywords), and <code>enum</code> (newer, less common Java features).
It also involves lazy initialization and performance, leaving opportunities to drill further.</p>

<h4>Standard Singleton</h4>

<p>According to &ldquo;Effective Java&rdquo; book, the best way to implement Singleton is to use single-item <code>enum</code>.</p>

<figure class='code'><figcaption><span>Singeton with example attribute, constructor, and method.</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">enum</span> <span class="n">OnlyOneOfMe</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">SINGLETON</span><span class="o">(</span><span class="s">&quot;King&quot;</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">OnlyOneOfMe</span><span class="o">(</span><span class="n">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">sayHello</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">&quot;Hello&quot;</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Interviewers while appreciating that you know <code>enum</code> and best practices, they won&rsquo;t let you go easily.
They will ask how it is implemented under the hood or using the older version.
Then, you should provide the standard idiom with lazy initialization and private constructor.</p>

<figure class='code'><figcaption><span>Singleton with private constructor</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnlyOneOfMe</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">static</span> <span class="n">OnlyOneOfMe</span> <span class="n">singleton</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">private</span> <span class="nf">OnlyOneOfMe</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// init code</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="n">OnlyOneOfMe</span> <span class="nf">getSingleton</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">singleton</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">singleton</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">OnlyOneOfMe</span><span class="o">();</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">singleton</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The common follow-up question is to ask whether if it is thread-safe.
You should be able to point out that since there are write operations on <code>singleton</code> variable, it is not thread-safe if many threads call <code>getSingleton</code> method.
To make it thread-safe (the next question), the simple fix is to add <code>synchronized</code> keyword to the function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">synchronized</span> <span class="kd">static</span> <span class="n">OnlyOneOfMe</span> <span class="nf">getSingleton</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="o">...</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you come this far, the next question is whether it is fast.
You should be able to point out that since there are locking at &ldquo;getSingleton&rdquo; method, it will be a bottleneck when many threads want to get the singleton instance.
The next subsection will address the best ways to do lazy initialization for performance.
However, it is shown here for completeness.</p>

<figure class='code'><figcaption><span>Lazy initialization for performance</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnlyOneOfMe</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SingletonHolder</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">static</span> <span class="kd">final</span> <span class="n">OnlyOneOfMe</span> <span class="n">singleton</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">OnlyOneOfMe</span><span class="o">();</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">private</span> <span class="nf">OnlyOneOfMe</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// init code</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="n">OnlyOneOfMe</span> <span class="nf">getSingleton</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">SingletonHolder</span><span class="o">.</span><span class="na">singleton</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Lazy initialization and Performance</h4>

<p>According to <a href="http://www.oracle.com/technetwork/articles/javase/bloch-effective-08-qa-140880.html">Bloch (&ldquo;Effective Java&rdquo; author)</a>, the single most important piece of advice is &ldquo;Don&rsquo;t do it unless you need to.&rdquo; The great majority of your initialization code should look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// Normal initialization, not lazy!</span>
</span><span class='line'><span class="kd">private</span> <span class="kd">final</span> <span class="n">FieldType</span> <span class="n">field</span> <span class="o">=</span> <span class="n">computeFieldValue</span><span class="o">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you need lazy initialization for correctness &ndash; but not for performance &ndash; just use a <code>synchronized</code> accessor. It&rsquo;s simple and clearly correct.</p>

<p>If you need better performance, your best choice depends on whether you&rsquo;re initializing a static field or an instance field. If it&rsquo;s a static field, use the lazy initialization holder class idiom:</p>

<figure class='code'><figcaption><span>Singleton static field.</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// Lazy initialization holder class idiom for static fields</span>
</span><span class='line'><span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FieldHolder</span> <span class="o">{</span>
</span><span class='line'>     <span class="kd">static</span> <span class="kd">final</span> <span class="n">FieldType</span> <span class="n">field</span> <span class="o">=</span> <span class="n">computeFieldValue</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="kd">static</span> <span class="n">FieldType</span> <span class="nf">getField</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">FieldHolder</span><span class="o">.</span><span class="na">field</span><span class="o">;</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This idiom is almost magical. There&rsquo;s synchronization going on, but it&rsquo;s invisible.
The Java Runtime Environment does it for you, behind the scenes.
And many VMs actually patch the code to eliminate the synchronization once it&rsquo;s no longer necessary, so this idiom is extremely fast.</p>

<p>If you need high-performance lazy initializing of an instance field, use the double-check idiom with a volatile field.
This idiom wasn&rsquo;t guaranteed to work until release 5.0, when the platform got a new memory model.
The idiom is very fast but also complicated and delicate, so don&rsquo;t be tempted to modify it in any way.
Just copy and paste &ndash; normally not a good idea, but appropriate here:</p>

<figure class='code'><figcaption><span>Double-check idiom for Singleton instance fields.</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// Double-check idiom for lazy initialization of instance fields.</span>
</span><span class='line'><span class="kd">private</span> <span class="kd">volatile</span> <span class="n">FieldType</span> <span class="n">field</span><span class="o">;</span>
</span><span class='line'><span class="n">FieldType</span> <span class="nf">getField</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">FieldType</span> <span class="n">result</span> <span class="o">=</span> <span class="n">field</span><span class="o">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// First check (no locking)</span>
</span><span class='line'>        <span class="kd">synchronized</span><span class="o">(</span><span class="k">this</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">result</span> <span class="o">=</span> <span class="n">field</span><span class="o">;</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="c1">// Second check (with locking)</span>
</span><span class='line'>                <span class="n">field</span> <span class="o">=</span> <span class="n">result</span> <span class="o">=</span> <span class="n">computeFieldValue</span><span class="o">();</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>References</h4>

<ul>
<li><a href="https://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Java">Double-checked locking</a></li>
<li><a href="http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html">Analysis of idiom before Java 1.5</a></li>
<li><a href="http://www.oracle.com/technetwork/articles/javase/bloch-effective-08-qa-140880.html">Bloch&rsquo;s interview</a></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Cuong Dong-Si</span></span>

      




<time class='entry-date' datetime='2011-01-21T15:18:42-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2011</span></span> <span class='time'>3:18 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/SqlTests/blog/categories/java/'>java</a>, <a class='category' href='/SqlTests/blog/categories/questions/'>questions</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://tdongsi.github.io/SqlTests/blog/2011/01/21/classic-interview-questions/" data-via="" data-counturl="http://tdongsi.github.io/SqlTests/blog/2011/01/21/classic-interview-questions/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/SqlTests/blog/2011/01/11/compare-languages-java-vs-c-plus-plus/" title="Previous Post: Compare languages: Java vs. C++">&laquo; Compare languages: Java vs. C++</a>
      
      
        <a class="basic-alignment right" href="/SqlTests/blog/2012/01/01/tutorial-sorting-algorithms/" title="Next Post: Tutorial: Sorting algorithms">Tutorial: Sorting algorithms &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
    <h1>About This Blog</h1>
    <p>Random interview experience and lessons.</p>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/SqlTests/blog/2022/12/03/bash-cookbook/">Bash Cookbook</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2022/12/02/docker-cli-cookbook/">Docker CLI Cookbook</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2022/12/01/groupadd-cookbook/">User Group and Related Commands</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2021/11/04/opencv/">OpenCV</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2021/11/02/anomaly-detection/">Anomaly Detection</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2021/11/01/tutorial-estimation-theory/">Tutorial: Estimation Theory</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2019/09/02/reserved-ip-addresses/">Reserved IP Addresses</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2019/09/01/network-question-bank/">Network Question Bank</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2018/08/06/vertica-sql-splitting-string/">Vertica SQL: Splitting String</a>
      </li>
    
      <li class="post">
        <a href="/SqlTests/blog/2018/08/05/tutorial-dashboard-for-business-analytics/">Tutorial: Dashboard for Business Analytics</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/SqlTests/blog/categories/addepar/'>addepar (1)</a></li><li><a href='/SqlTests/blog/categories/algorithm/'>algorithm (13)</a></li><li><a href='/SqlTests/blog/categories/algorithmdesign/'>algorithmdesign (1)</a></li><li><a href='/SqlTests/blog/categories/apple/'>apple (1)</a></li><li><a href='/SqlTests/blog/categories/aws/'>aws (1)</a></li><li><a href='/SqlTests/blog/categories/bash/'>bash (3)</a></li><li><a href='/SqlTests/blog/categories/book/'>book (4)</a></li><li><a href='/SqlTests/blog/categories/c-plus-plus/'>c++ (1)</a></li><li><a href='/SqlTests/blog/categories/computervision/'>computervision (1)</a></li><li><a href='/SqlTests/blog/categories/concurrency/'>concurrency (2)</a></li><li><a href='/SqlTests/blog/categories/database/'>database (3)</a></li><li><a href='/SqlTests/blog/categories/design/'>design (3)</a></li><li><a href='/SqlTests/blog/categories/facebook/'>facebook (5)</a></li><li><a href='/SqlTests/blog/categories/golang/'>golang (1)</a></li><li><a href='/SqlTests/blog/categories/google/'>google (1)</a></li><li><a href='/SqlTests/blog/categories/graph/'>graph (3)</a></li><li><a href='/SqlTests/blog/categories/gtg/'>gtg (3)</a></li><li><a href='/SqlTests/blog/categories/java/'>java (5)</a></li><li><a href='/SqlTests/blog/categories/javascript/'>javascript (2)</a></li><li><a href='/SqlTests/blog/categories/machinelearning/'>machinelearning (1)</a></li><li><a href='/SqlTests/blog/categories/math/'>math (2)</a></li><li><a href='/SqlTests/blog/categories/mysql/'>mysql (1)</a></li><li><a href='/SqlTests/blog/categories/network/'>network (2)</a></li><li><a href='/SqlTests/blog/categories/os/'>os (1)</a></li><li><a href='/SqlTests/blog/categories/python/'>python (3)</a></li><li><a href='/SqlTests/blog/categories/questions/'>questions (9)</a></li><li><a href='/SqlTests/blog/categories/salesforce/'>salesforce (1)</a></li><li><a href='/SqlTests/blog/categories/sql/'>sql (3)</a></li><li><a href='/SqlTests/blog/categories/sqlrunner/'>sqlrunner (8)</a></li><li><a href='/SqlTests/blog/categories/systemdesign/'>systemdesign (1)</a></li><li><a href='/SqlTests/blog/categories/testing/'>testing (9)</a></li><li><a href='/SqlTests/blog/categories/todo/'>todo (1)</a></li><li><a href='/SqlTests/blog/categories/tutorial/'>tutorial (10)</a></li><li><a href='/SqlTests/blog/categories/vertica/'>vertica (3)</a></li></ul>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2021 - Cuong Dong-Si -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
